<%- include('../partials/html-head') %>
<link rel="stylesheet" href="/stylesheets/packages/show.css" />
<%- include('../partials/nav') %>

<main>
  <h1>Package Details</h1>
    <div><strong>Destination: </strong><%= vacationPackage.destination  %></div>
    <div><strong>Duration:</strong> <%= vacationPackage.duration  %> weeks</div>
    <div><strong>Tour Guide: </strong> <%= vacationPackage.tourGuide  %></div>
    <div><strong>Trip Date: </strong><%= vacationPackage.tripDate  %></div>
    <div><strong>Created by: </strong><%= vacationPackage.owner.name %></div>
    <% if (vacationPackage.owner.equals(user?.profile._id)) { %>
      <div>
        <form action="/packages/<%= vacationPackage._id %>/edit" method="GET">
          <button class ="edit-btn" type="submit">Edit Package</button>
        </form>  
      </div> 
      <div>
        <form action="/packages/<%= vacationPackage._id %>?_method=DELETE" method="POST">
          <button class ="del-btn" type="submit">Delete Package</button>
        </form>
      </div>
    <% } %>
    <% if (user?.profile._id) { %>
      <h1>Bookings</h1>
        <form action="/packages/<%= vacationPackage._id %>/tickets" id="add-ticket-form" method="post">
          <label for="content-textarea">Booked By:</label>
          <input name="bookedBy" required>
          <label for="content-textarea">Total people:</label>
          <input name="numOfPeople" required>
          <label for="price-select">Price:</label>
          <input type="number" name="price" required>
          <button type="submit">Book</button>
        </form>
        <br>
        <% if (vacationPackage.tickets.length) { %>
          <table>
            <thead>
              <tr>
                <th>Booked by</th>
                <th>Number of people</th>
                <th>Price</th>
              </tr>
            </thead>
            <tbody>
              <% vacationPackage.tickets.forEach(function(ticket) { %>
                  <tr>
                    <td><%= ticket.bookedBy %></td>
                    <td><%= ticket.numOfPeople %></td>
                    <td> $ <%=ticket.price %></td>
                  </tr>
              <% }) %>
            </tbody>
          </table>
        <% } else { %>
          <h3>No Bookings Yet</h3>
        <% } %>
    <% } %>     
</main>

<%- include('../partials/footer') %>