<%- include('../partials/html-head') %>
<link rel="stylesheet" href="/stylesheets/packages/show.css" />
<%- include('../partials/nav') %>

<main>
    <div class="container">
      <div class="row">
        <h1>Package Details</h1>
            <div class="col-6"><strong>Destination: </strong><%= vacationPackage.destination  %></div>
            <div class="col-6"><strong>Duration:</strong> <%= vacationPackage.duration  %> weeks</div>
            <div class="col-6"><strong>Tour Guide: </strong> <%= vacationPackage.tourGuide  %></div>
            <div class="col-6"><strong>Trip Date: </strong><%= vacationPackage.tripDate  %></div>
            <div class="col-6"><strong>Created by: </strong><%= vacationPackage.owner.name %></div>
            <% if (vacationPackage.owner.equals(user?.profile._id)) { %>
              <form action="/packages/<%= vacationPackage._id %>/edit" method="GET">
                <div class="col-12">
                  <button class="h4" type="submit">Edit Package</button>
                </div> 
              </form>
              <form action="/packages/<%= vacationPackage._id %>?_method=DELETE" method="POST">
                <div class="col-12">
                  <button class="h4" type="submit">Delete Package</button>
                </div>   
              </form>
            <% } %>
      </div>
    </div>
    <% if (user?.profile._id) { %>
      <h1>Bookings</h1>
        <form action="/packages/<%= vacationPackage._id %>/tickets" id="add-ticket-form" method="post">
          <label for="content-textarea">Booked By:</label>
          <input name="bookedBy">
          <label for="content-textarea">Number of people:</label>
          <input name="numOfPeople">
          <label for="price-select">Price:</label>
          <input type="number" name="price" required>
          <button class="h4" type="submit">Book</button>
        </form>
        <% if (vacationPackage.tickets.length) { %>
          <table>
            <thead>
              <tr>
                <th>Booked by</th>
                <th>Number of people</th>
                <th>Price</th>
              </tr>
            </thead>
            <tbody>
              <% vacationPackage.tickets.forEach(function(ticket) { %>
                  <tr>
                    <td><%= ticket.bookedBy %></td>
                    <td><%= ticket.numOfPeople %></td>
                    <td> $ <%=ticket.price %></td>
                  </tr>
              <% }) %>
            </tbody>
          </table>
        <% } else { %>
          <h3>No Bookings Yet</h3>
        <% } %>
    <% } %>     
</main>

<%- include('../partials/footer') %>